import psycopg2

try:
    connection = None
    cur = None
    connection = psycopg2.connect(
        host="localhost",
        port="5432",
        database="postgres",
        user="postgres",
        password="admin"
    )
    cur = connection.cursor()

    create_tbl_script = ''' CREATE TABLE IF NOT EXISTS EMPLOYEE
                        (
                            ID      INT PRIMARY  KEY,
                            NAME    VARCHAR(40) NOT NULL,
                            SALARY  INT,
                            DEPT_ID VARCHAR(30))'''
    

    insert_tbl_script = 'INSERT INTO EMPLOYEE(ID,NAME,SALARY,DEPT_ID) VALUES(%s,%s,%s,%s)'
    insert_tbl_values = (1,'kumar', 100,'D1')
    cur.execute(insert_tbl_script, insert_tbl_values)
   

    connection.commit()

    cur.close()
    connection.close()
except Exception as error:
    print(error)
finally:
    if cur is None:
        cur.close()
    if connection is None :   
        connection.close()